= 03. Attacks on RSA

== RSA with same modulus and two coprime exponents
RSA - e1 = 65537, e2 = 65539

A cryptographic module encrypts symmetric 128-bit keys using the RSAES-PKCS1-v1_5 scheme (see PKCS#1). Due to an error, one single key (including padding) was encrypted two times with the same modulus N and two public exponents e_1 and e_2. Two corresponding ciphertexts c_1 and c_2 were created. Find the value of the symmetric key, given:

n = 1189655982854811921290816344838417439563007994883299228153515390104375\
5408931886015602563231044071038269378941101310031775231876298264357865\
3389773295480843102759393358161262015134849938906968092326049472737955\
5610822231670846920488073854857256185528571936381220606925054674789448\
05145300591376251274273515157

e1 = 2^16+1

e2 = 2^16+3

c1 = 6081621398076084552967654637369103517540104052834815880719527219763787\
7750268815192637665579710465353000124830228342142959747841208633969729\
2866236522397217782381719218972948350492185458457378778233358713487623\
2375732529797974620106115576077074666967292042374545002641228333984357\
2857310640294435173721835662

c2 = 8476734604125002544771920943166568933506894408238542917625697388513594\
3447486083620603665199185292422798119203294136383555178389553236514089\
6291893691568532389709352763979212832939372329211058470013992684594937\
6098436805615799102483542251221097365898098679251463462588589446367228\
8737551800677117035834947094

Hint: Extended Euclidean algorithm applied on e1 and e2.

Note: In Mathematica, you can use for example ExtendedGCD, PowerMod, Mod

== Fault attack on RSA-CRT, broadcast attack
*Homework* for 4 points: (due date 26.10.2022)

*Part 1*: When signing an (unknown) message using the RSASSA-PKCS1-v1_5 scheme (see PKCS#1), an error was introduced during the computation of the RSASP1 signing transformation (see PKCS#1). Chinese Remainder Theorem was used, the error affected only the partial signature value modulo p, ie. value called in PKCS#1 signature as s_1. The signer later discovered that the computed signature is invalid, and signed the same message again. This time all went without errors. Find the signer's private key, given the public modulus N, public exponent e, faulty signature value f, and correct signature value s, where:

n=143439281935793709829883511119512297318347597781777879206016778171534720301126\
138047071671599318397710025065932294231888139238578615677641709345935975961129\
727859596609343289124965796285308717120051606006794321837387662808710892762405\
359764253183416603706120250336984377143647112873468386573559510267301025317

e=2^16+1

f=712511763782220265918252709247103335987550256005834083984176730449480368386052\
031993654533956845418357663386611626726398611826562201659472521314258109381326\
671683709284573995792180329461662294956358574343965158643659191882229252050586\
41667971268925279334818704393729730175259569121845705737661313402980864137

s=152237025824459802868086069274071478726068164085150946711959415737478737765427\
638599888513094208355894101317729630961531082825091758716963421631965500328995\
224290257173958382743050992967862580690325175786284309622104762210017195593306\
46207213315978859400699157086660962631721005185511377251893703145230857109

Hint: Fault attack on RSA-CRT.

*Part 2*: A secret message (one 128bit symmetric key) was sent to 3 recipients encrypted with RSA with each recipient's public key, with the same padding value (padding scheme RSAES-PKCS1-V1_5). The public keys are:

n1=87617523948177647312867775239694626750987292134627889364808905617827332876105350879470010739139344292545770540409899305653944242239880100328192428705797212072724323423041291119344048342058210621360780869091664865999689405851181985243820506729202457035583684007010204771260794056165692617016320638991306056971; 

e1=3;

n2=157924041114647369229870617094437851802316941267184788933608836375564767772848701641688858696007853369291135059337850679893135460205320456206898932645455436133369113857496950130545810994125246833907260221346227394884508785210676049418226525446419689791538932619557120002466506317385975439092143284415874027211; 

e2=3;

n3=131838608633676640357181447748492700119690962351507876169571398908111512224354777757996176099828271304349963607084588120858016224316252565697977767839599356978916409295387565046205091469855019418988788689432116878030657624011562009433753926073552436199075792228327510102237935074223902088975550473614367494057; 

e3=3;

The three cryptograms were observed on the network:

c1=65212541317751284945506670900226056975795010934933260071670282892032802604842097393658979526420346854804581094518520227574641987146937473402588909454892030738136515156287257945593373062628072825528841140843460692938629933406016148043093433950475747067155338655038454056567193537623903933983553464412593090069;

c2=156382357585467430660629788383054623242324250227822556985971693848351330121162133454674039801720527155134137933856606359528665363372668511326729412708820502692450710775929374472783735915284966718107235882039123636874001815937218546463720092113732842309236191032972133895854339528436872197043533983579035222837;

c3=60503578526025909836402242708419858013018067036973039030239080408145933920566256907144297043756503316641584712782889200080106252564748066020635642241350111055877635349767719255482806493092144842653965557405779843774330253634516323287118947492451943926212539801046839516868238865378114669552919766008255657505;

Determine the value of the secret symmetric key.

Hint: Broadcast RSA attack, Chinese remainder theorem.

